<app-header></app-header>

<section class="app-shell">
  <div class="app-section__header">
    <p class="app-section__subtitle">Checkout</p>
    <h2 class="app-section__title">Review and confirm your order</h2>
  </div>

  <div class="app-alert" *ngIf="message" [ngClass]="getMessageClass(1)">
    {{ message }}
  </div>

  <ng-container *ngIf="hasCheckoutItems; else emptyCheckout">
    <div class="app-table-wrapper">
      <table class="app-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Price</th>
            <th>Description</th>
            <th>Category</th>
            <th>Quantity</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let person of cartItems">
            <td>{{ person.id }}</td>
            <td>{{ person.name }}</td>
            <td>{{ person.price | currency:'USD':'symbol':'1.2-2' }}</td>
            <td>{{ person.description }}</td>
            <td>{{ person.category }}</td>
            <td>{{ person.quantity }}</td>
            <td>{{ person.total | currency:'USD':'symbol':'1.2-2' }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <article class="app-card">
      <div class="app-metric">
        <span class="app-metric__label">Total to pay</span>
        <span class="app-metric__value">{{ totalDue | currency:'USD':'symbol':'1.2-2' }}</span>
      </div>
      <div class="app-card__actions">
        <label class="app-pill">
          <input type="radio" name="payment" (click)="check('CashOnDelivery')" value="CashOnDelivery">
          Cash on delivery
        </label>
        <label class="app-pill">
          <input type="radio" name="payment" (click)="check('CardPayMent')" value="CardPayMent">
          Card payment
        </label>
      </div>
    </article>

    <form *ngIf="state==='CardPayMent'" #myForm="ngForm" (ngSubmit)="submitPayment(myForm)" class="app-card">
      <h3>Card details</h3>
      <div class="form-grid">
        <input
          class="form-control"
          type="text"
          name="cardnumber"
          placeholder="0000 0000 0000 0000"
          [(ngModel)]="userCard.cardNumber"
          maxlength="21">

        <input
          class="form-control"
          type="text"
          name="month"
          placeholder="MM"
          [(ngModel)]="userCard.expMonth"
          maxlength="2">

        <input
          class="form-control"
          type="text"
          name="year"
          placeholder="YY"
          [(ngModel)]="userCard.expYear"
          maxlength="2">

        <input
          class="form-control"
          type="text"
          name="ccv"
          placeholder="CVV"
          [(ngModel)]="userCard.ccv"
          maxlength="3">
      </div>
      <div class="app-card__actions">
        <button class="app-btn" type="submit" id="submit">Submit payment</button>
      </div>
    </form>
  </ng-container>

  <ng-template #emptyCheckout>
    <div class="app-empty">
      <p>Your checkout queue is empty.</p>
    </div>
  </ng-template>
</section>

